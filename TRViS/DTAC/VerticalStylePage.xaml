<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
	xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
	xmlns:dtac="clr-namespace:TRViS.DTAC"
	xmlns:models="clr-namespace:TRViS.Models"
	x:Class="TRViS.DTAC.VerticalStylePage"
	BackgroundColor="White"
	Shell.BackgroundColor="#080"
	Title="変臨B999行路">
	<ContentPage.Resources>
		<ResourceDictionary>
			<Color x:Key="DarkerGreen">#151</Color>

			<x:Double x:Key="FontSize_Default">16</x:Double>
			<x:Double x:Key="FontSize_Large">28</x:Double>
			<x:Double x:Key="FontSize_Midium">22</x:Double>

			<ColumnDefinitionCollection x:Key="TimetableColumnWidthCollection">
				<!-- 運転時分 -->
				<ColumnDefinition Width="64"/>
				<!-- 停車場名 -->
				<ColumnDefinition Width="128"/>
				<!-- 着 -->
				<ColumnDefinition Width="128"/>
				<!-- 発 (通)  -->
				<ColumnDefinition Width="128"/>
				<!-- 着線/発線 -->
				<ColumnDefinition Width="64"/>
				<!-- 制限速度 -->
				<ColumnDefinition Width="64"/>
				<!-- 記事 -->
				<ColumnDefinition Width="*"/>
				<!-- マーカー -->
				<ColumnDefinition Width="64"/>
			</ColumnDefinitionCollection>

			<Style x:Key="LabelStyle" TargetType="Label">
				<Setter Property="HorizontalOptions" Value="Center"/>
				<Setter Property="VerticalOptions" Value="Center"/>
				<Setter Property="FontSize" Value="{StaticResource FontSize_Default}"/>
				<Setter Property="FontFamily" Value="Hiragino Sans"/>
				<Setter Property="Margin" Value="1"/>
				<Setter Property="LineBreakMode" Value="NoWrap"/>
			</Style>
			<Style TargetType="Label" BasedOn="{StaticResource LabelStyle}"/>
			<Style x:Key="HeaderLabel" TargetType="Label" BasedOn="{StaticResource LabelStyle}">
				<Setter Property="TextColor" Value="#555"/>
			</Style>
			<Style x:Key="TimetableLabel" TargetType="Label" BasedOn="{StaticResource LabelStyle}">
				<Setter Property="TextColor" Value="Black"/>
				<Setter Property="FontSize" Value="{StaticResource FontSize_Large}"/>
				<Setter Property="FontAttributes" Value="Bold"/>
			</Style>
			<Style x:Key="TimetableLargeNumberLabel" TargetType="Label" BasedOn="{StaticResource TimetableLabel}">
				<Setter Property="FontFamily" Value="Helvetica"/>
				<Setter Property="VerticalOptions" Value="End"/>
			</Style>
			<Style x:Key="TimetableMidiumNumberLabel" TargetType="Label" BasedOn="{StaticResource TimetableLargeNumberLabel}">
				<Setter Property="FontSize" Value="{StaticResource FontSize_Midium}"/>
			</Style>
			<Style x:Key="TimetableDefaultNumberLabel" TargetType="Label" BasedOn="{StaticResource TimetableLargeNumberLabel}">
				<Setter Property="FontSize" Value="{StaticResource FontSize_Default}"/>
				<Setter Property="Margin" Value="1,3"/>
			</Style>

			<Style x:Key="SeparatorLine" TargetType="Line">
				<Setter Property="HorizontalOptions" Value="End"/>
				<Setter Property="Margin" Value="0,4"/>
				<Setter Property="BackgroundColor" Value="#aaa"/>
			</Style>

			<Style x:Key="TimetableSeparatorLine" TargetType="Line">
				<Setter Property="VerticalOptions" Value="End"/>
				<Setter Property="BackgroundColor" Value="#aaa"/>
				<Setter Property="Grid.ColumnSpan" Value="8"/>
			</Style>

			<Style TargetType="dtac:TimeCell">
				<Setter Property="VerticalOptions" Value="Center"/>
				<Setter Property="HorizontalOptions" Value="Center"/>
				<Setter Property="DefaultLabelStyle" Value="{StaticResource TimetableLargeNumberLabel}"/>
				<Setter Property="SSLabelStyle" Value="{StaticResource TimetableDefaultNumberLabel}"/>
				<Setter Property="TextColor" Value="Black"/>
			</Style>

			<Style x:Key="LastStopLine" TargetType="Line">
				<Setter Property="BackgroundColor" Value="Black"/>
				<Setter Property="StrokeThickness" Value="4"/>
				<Setter Property="X1" Value="22"/>
				<Setter Property="X1" Value="106"/>
				<Setter Property="Y1" Value="0"/>
				<Setter Property="Y2" Value="0"/>
				<Setter Property="VerticalOptions" Value="Center"/>
				<Setter Property="HorizontalOptions" Value="Center"/>
			</Style>
		</ResourceDictionary>

	</ContentPage.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="60"/>
			<RowDefinition Height="60"/>
			<RowDefinition Height="50"/>
			<RowDefinition Height="50"/>
			<RowDefinition Height="50"/>
			<RowDefinition Height="60"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="60"/>
		</Grid.RowDefinitions>

		<dtac:TimetableHeader
			BackgroundColor="#ddd"
			LabelStyle="{StaticResource HeaderLabel}"
			SeparatorLineStyle="{StaticResource SeparatorLine}"
			FontSize_Large="{StaticResource FontSize_Large}"
			ColumnDefinitions="{StaticResource TimetableColumnWidthCollection}"
			Grid.Row="5"/>

		<ListView
			x:Name="MyList"
			BackgroundColor="White"
			SelectionMode="None"
			Grid.Row="6"
			RowHeight="60">
			<ListView.ItemTemplate>
				<DataTemplate
					x:DataType="models:TimetableRow">
					<ViewCell>
						<Grid
							ColumnDefinitions="{StaticResource TimetableColumnWidthCollection}">
							<Grid
								Margin="4"
								VerticalOptions="End"
								Grid.Column="0">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="*"/>
								</Grid.ColumnDefinitions>
								<Label
									Style="{StaticResource TimetableMidiumNumberLabel}"
									HorizontalOptions="End"
									Margin="0"
									Grid.Column="0"
									Text="{Binding DriveTimeMM}"/>
								<Label
									Style="{StaticResource TimetableDefaultNumberLabel}"
									Margin="1"
									HorizontalOptions="Start"
									Grid.Column="1"
									Text="{Binding DriveTimeSS, StringFormat='{0:D2}'}"/>
							</Grid>
							<Label
								Style="{StaticResource TimetableLabel}"
								Margin="0"
								Grid.Column="1"
								Text="{Binding SpacedStationName}"/>

							<Label
								Style="{StaticResource TimetableLabel}"
								IsVisible="{Binding HasBracket}"
								Grid.Column="2"
								HorizontalOptions="Start"
								Text="("/>
							<Label
								Style="{StaticResource TimetableLabel}"
								IsVisible="{Binding IsOperationOnlyStop}"
								Grid.Column="2"
								HorizontalOptions="Start"
								Text="["/>

							<dtac:TimeCell
								TimeData="{Binding ArriveTime}"
								Grid.Column="2">
								<dtac:TimeCell.Triggers>
									<DataTrigger Binding="{Binding IsPass}" Value="True" TargetType="dtac:TimeCell">
										<Setter Property="IsVisible" Value="False"/>
									</DataTrigger>
								</dtac:TimeCell.Triggers>
							</dtac:TimeCell>

							<Image
								IsVisible="{Binding IsPass}"
								Aspect="AspectFit"
								HeightRequest="22"
								WidthRequest="22"
								Source="dtac_pass_arrow.png"
								Grid.Column="2"
								HorizontalOptions="Center"
								VerticalOptions="Center"/>

							<Label
								Style="{StaticResource TimetableLabel}"
								IsVisible="{Binding HasBracket}"
								Grid.Column="2"
								HorizontalOptions="End"
								Text=")"/>

							<dtac:TimeCell
								TimeData="{Binding DepartureTime}"
								Grid.Column="3">
								<dtac:TimeCell.Triggers>
									<DataTrigger Binding="{Binding IsPass}" Value="True" TargetType="dtac:TimeCell">
										<Setter Property="TextColor" Value="Red"/>
									</DataTrigger>
									<DataTrigger Binding="{Binding IsLastStop}" Value="True" TargetType="dtac:TimeCell">
										<Setter Property="IsVisible" Value="False"/>
									</DataTrigger>
								</dtac:TimeCell.Triggers>
							</dtac:TimeCell>

							<Grid
								IsVisible="{Binding IsLastStop}"
								Grid.Column="3">
								<Grid.RowDefinitions>
									<RowDefinition Height="*"/>
									<RowDefinition Height="*"/>
									<RowDefinition Height="*"/>
									<RowDefinition Height="*"/>
								</Grid.RowDefinitions>
								<Line
									Style="{StaticResource LastStopLine}"
									Grid.Row="1"/>
								<Line
									Style="{StaticResource LastStopLine}"
									Grid.Row="2"/>
							</Grid>

							<Label
								Style="{StaticResource TimetableLabel}"
								IsVisible="{Binding IsOperationOnlyStop}"
								Grid.Column="3"
								HorizontalOptions="End"
								Text="]"/>

							<Label
								Style="{StaticResource TimetableLabel}"
								TextColor="Red"
								Grid.Column="4"
								Text="{Binding TrackName}"/>

							<Grid
								Grid.Column="5">
								<Grid.RowDefinitions>
									<RowDefinition Height="*"/>
									<RowDefinition Height="*"/>
								</Grid.RowDefinitions>
								<Label
									Style="{StaticResource TimetableLargeNumberLabel}"
									VerticalOptions="End"
									HorizontalOptions="Start"
									Margin="8,-4"
									Grid.Row="0"
									Text="{Binding RunInLimit}"/>
								<Label
									Style="{StaticResource TimetableLargeNumberLabel}"
									VerticalOptions="Start"
									HorizontalOptions="End"
									Margin="8,-4"
									Grid.Row="1"
									Text="{Binding RunOutLimit}"/>
							</Grid>

							<Label
								Style="{StaticResource TimetableLabel}"
								Grid.Column="6"
								Text="{Binding Remarks}"/>

							<Line
								Style="{StaticResource TimetableSeparatorLine}"/>
						</Grid>
					</ViewCell>
				</DataTemplate>
			</ListView.ItemTemplate>
		</ListView>
	</Grid>
</ContentPage>
